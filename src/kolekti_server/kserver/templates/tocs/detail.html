{% extends "base.html" %}

{% block extracss %}
    <link rel="stylesheet" type="text/css"  href="/static/css/kolekti-tocs.css"></script>
    <link rel="stylesheet" type="text/css"  href="/criteria.css"></script>
{% endblock %}


{% block extrascripts %}
    <script src="/static/js/kolekti-tocs.js"></script>
    <script src="/static/js/kolekti-tocs-filter.js"></script>
{% endblock %}

{% block title %}
    <a href="#" data-toggle="collapse" data-target="#collapseMeta" aria-expanded="false" aria-controls="collapseMeta">{{ tocfile }}</a>
{% comment %}
    <span class="pull-right">
      <small><button class="btn btn-primary btn-xs btn-kolekti-metatoc" data-toggle="collapse" data-target="#collapseMeta" aria-expanded="false" aria-controls="collapseMeta">      
	  Plus...       
      </button></small>
    </span>
{% endcomment %}
{% endblock %}


{% block menu %}
    
    <div>
      <button type="button" class="btn btn-default btn-block disabled" id="btn_save">
	{# <span class="glyphicon glyphicon-save"></span> #}
	Enregistrer
      </button>
      <button type="button" class="btn btn-default btn-block" id="btn_save_as">
	{# <span class="glyphicon glyphicon-save"></span> #}
	Enregistrer sous...
      </button><br>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
	<h4 class="panel-title">
	  <a data-toggle="collapse" href="#collapsePublier">
	    Publication
	  </a>
	</h4>
      </div>
      <div id="collapsePublier" class="panel-collapse collapse in">
	<div class="panel-body">
	  {% for job in jobs %}
{% comment %}
	  <div class="jobselect">
	  <div class="checkbox" id="title_job_{{ job.name }}" >
	    <label>
  	      <input type="checkbox" class="publish_job" id="job_{{ job.name }}" data-kolekti-jobname="{{ job.name }}" data-kolekti-job="{{ job.path }}"/>
	      {{ job.name }}
	    </label>
	  </div>

	  <div id="collapse_job_{{ job.name }}" class="panel panel-collapse panel-default collapse" role="tabpanel"
	       aria-labelledby="title_job_{{ job.name }}">
	    <div class="panel-body jobdetail row">
{% endcomment %}

	    <div class="row {% if job.name != tocjob %}hidden{% endif %} kolekti-job kolekti-job-{{ job.name }}"
		 data-kolekti-jobname="{{ job.name }}" data-kolekti-job="{{ job.path }}">
	      <div class="col-sm-12 col-md-6">

		<h6>profiles</h6>
		{% for profile in job.profiles %}
		<div class="checkbox" checked>
		  <label>
  		    <input type="checkbox" class="publish_job_profile" id="job_{{ job.name }}_{{ profile }}" data-kolekti-profile="{{ profile }}" checked/>
		    {{ profile }}
		  </label>
		</div>
		{% endfor %}
	      </div>
	      <div class="col-sm-12 col-md-6">
		<h6>scripts</h6>
		{% for script in job.scripts %}
		<div class="checkbox">
		  <label>
  		    <input type="checkbox" class="publish_job_script" id="job_{{ job.name }}_{{ script }}" data-kolekti-script="{{ script }}" checked/>
		    {{ script }}
		  </label>
		</div>
		{% endfor %}
	      </div>
	    </div>

{% comment %}
	  </div>
	  </div>
{% endcomment %}
	  {% endfor %}
	  <div class="row">
	    <div class="col-sm-12 col-md-12">
	      <button type="button" class="btn btn-block btn-default btn_publish" id="btn_draft">Publier</button>
	    </div>
	    <div class="col-sm-12 col-md-12">
	      <button type="button" class="btn btn-block btn-default btn_publish" id="btn_release">Créer un instantané</button>
	    </div>
	  </div>
	</div>
      </div>
      <div class="panel-footer">
	  <a id="editjoblink" href="/settings/editjob?job={{ tocjob }}"><small><span class="glyphicon glyphicon-cog"> </span></small> Editer les paramètres <em><span class="label_job">{{ tocjob }}</span></em></a>
      </div>
    </div>


    <div class="panel panel-default">
      <div class="panel-heading">
	<h4 class="panel-title">
	  <a data-toggle="collapse" href="#collapseAfficher">
	    Affichage
	  </a>
	</h4>
      </div>
      <div id="collapseAfficher" class="panel-collapse collapse in">
	<div class="panel-body">
	  <div class="row">
	    <div class="col-sm-12 col-md-6">
	      <button type="button" class="btn btn-default btn-block" id="btn_expand_all">
		<span class="glyphicon glyphicon-resize-full"></span> 
		Tout déplier
	      </button>
	    </div>
	    <div class="col-sm-12 col-md-6">
	      <button type="button" class="btn btn-default btn-block" id="btn_collapse_all">
		<span class="glyphicon glyphicon-resize-small"></span> 
		Tout plier
	      </button>
	    </div>
	  </div>
	  <br>

	  <div class="panel panel-default">
	    <div class="panel-heading">Vue filtrée</div>
	    <ul class="list-group" id="userconditions" >
	      <!-- filtrage -->	    
	    </ul>
	  </div>
<!--
	  <button type="button" class="btn btn-block btn-default" data-toggle="button" aria-pressed="false" autocomplete="off" id="btn_toggle_conditions">
	    Afficher les conditions
	  </button>
-->
	</div>
      </div>
    </div>      
    <button type="button" class="btn btn-default btn-block" id="btn_audit">
      {# <span class="glyphicon glyphicon-resize-small"></span> #}
      Générer un diagnostic...
    </button>
{% endblock %}


{% block content %}

  <div class="main">
   <div id="toc_root" data-kolekti-title="{{ toctitle }}" data-kolekti-path="{{ tocpath }}" data-kolekti-job="{{ tocjob }}">
    <div class="panel panel-default">
      <div id="collapseMeta" class="panel-collapse collapse">
	<div class="panel-body" id="tocmeta">
	  <div class="row">
	    <div class="col-sm-12 col-md-6">
	      <p>Titre : {{ toctitle }} <button type="button" class="btn btn-default btn-xs">Modifier</button></p>
	      <p>Emplacement : {{ tocpath }}</p>
	    </div>
	    <div class="col-sm-12 col-md-6">
	      Parametres de publication :
	      <span class="btn-group">
		<button type="button" class="btn btn-default" data-toggle="dropdown" aria-haspopup="true" role="button" aria-expanded="false">		  
		  <span class="label_job">{{ tocjob }}</span>

		  <span class="caret"></span>
		</button>

		<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
		  {% for job in jobs %}
		  <li role="presentation">
		    <a href="#" role="menuitem" tabindex="-1" class="entry_tocjob">
		      {{ job.name }}
		    </a>
		  </li>
		  {% endfor %}
		</ul>
	      <span>
	    </div>
	  </div>
	</div>
      </div>
    </div>
  {{ toccontent|safe}}
   </div>
</div>
{% endblock %}

