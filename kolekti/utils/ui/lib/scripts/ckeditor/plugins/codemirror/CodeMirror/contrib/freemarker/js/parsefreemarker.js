var FreemarkerParser=Editor.Parser=(function(){var b={'else':true,elseif:true},c=(function(){function e(l,m){var n=l.next();if(n=='<'){if(l.equals('!')){l.next();if(l.lookAhead('--',true)){m(k('freemarker-comment','-->'));return null;}else return 'freemarker-text';}else{l.nextWhileMatches(/[\#\@\/]/);m(h('>'));return 'freemarker-boundary';}}else if(n=='['){if(l.matches(/[\#\@]/)){m(f(l.peek(),']',false));return 'freemarker-boundary';}else if(l.matches(/\//)){m(g(']'));return 'freemarker-boundary';}else return 'freemarker-text';}else if(n=='$'){if(l.matches(/[\{\w]/)){m(f('{','}',true));return 'freemarker-boundary';}else return 'freemarker-text';}else{l.nextWhileMatches(/[^\$<\n]/);return 'freemarker-text';}};function f(l,m,n){return function(o,p){var q=o.next();if(q==l){p(h(m));return 'freemarker-boundary';}else if(n){o.nextWhileMatches(/\w/);p(e);return 'freemarker-identifier';}else{p(e);return null;}};};function g(l){return function(m,n){var o=m.next();if(o=='/'){n(f(m.peek(),l,false));return 'freemarker-boundary';}else{n(e);return null;}};};function h(l){return function(m,n){var o=m.next();if(o==l){n(e);return 'freemarker-boundary';}else if(/[?\/]/.test(o)&&m.equals(l)){m.next();n(e);return 'freemarker-boundary';}else if(/[?!]/.test(o)){if(o=='?'){if(m.peek()=='?')m.next();else n(i(h(l)));}return 'freemarker-punctuation';}else if(/[()+\/\-*%=]/.test(o))return 'freemarker-punctuation';else if(/[0-9]/.test(o)){m.nextWhileMatches(/[0-9]+\.?[0-9]* /);return 'freemarker-number';}else if(/\w/.test(o)){m.nextWhileMatches(/\w/);return 'freemarker-identifier';}else if(/[\'\"]/.test(o)){n(j(o,h(l)));return 'freemarker-string';}else{m.nextWhileMatches(/[^\s\u00a0<>\"\'\}?!\/]/);return 'freemarker-generic';}};};function i(l){return function(m,n){var o=m.peek();if(/[a-zA-Z_]/.test(o)){m.next();m.nextWhileMatches(/[a-zA-Z_0-9]+/);n(l);return 'freemarker-builtin';}else n(l);};};function j(l,m){return function(n,o){while(!n.endOfLine()){if(n.next()==l){o(m);break;}}return 'freemarker-string';};};function k(l,m){return function(n,o){while(!n.endOfLine()){if(n.lookAhead(m,true)){o(e);break;}n.next();}return l;};};return function(l,m){return tokenizer(l,m||e);};})();function d(e){var f=c(e),g,h=[w],i=0,j=0,k=null,l=null,m;function n(G){for(var H=G.length-1;H>=0;H--)h.push(G[H]);};function o(){n(arguments);m=true;};function p(){n(arguments);m=false;};function q(){g.style+=' freemarker-error';};function r(G){return function(H,I){if(I==G)o();else{q();o(arguments.callee);}};};
function s(G,H){l={prev:l,name:G,indent:j,startOfLine:H};};function t(){l=l.prev;};function u(G){return function(H,I,J,K){var L=G;H=v(K);if(L&&/^<\/\#/.test(H)||L&&/^\[\/\#/.test(H))L=L.prev;while(L&&!L.startOfLine)L=L.prev;if(L){if(/^<\#else/.test(H)||/^\[\#else/.test(H))return L.indent;return L.indent+indentUnit;}else return 0;};};function v(G){var H=G?G.nextSibling:null,I=H?H.nextSibling:null,J=G&&G.currentText?G.currentText:'';if(H&&H.currentText){J+=H.currentText;if(I&&I.currentText)J+=I.currentText;}return J;};function w(){return p(y,w);};var x={'freemarker-text':true,'freemarker-comment':true};function y(G,H){if(H=='<#')o(B,D,F('/>','>',i==1));else if(H=='</#')o(C,r('>'));else if(H=='['&&G=='freemarker-boundary')o(z);else o();};function z(G,H){if(H=='#')o(B,E,F('/]',']',i==2));else if(H=='/')o(A);else q();};function A(G,H){if(H=='#')o(C,r(']'));else q();};function B(G,H){if(G=='freemarker-identifier'){k=H.toLowerCase();g.style='freemarker-directive';o();}else{k=null;p();}};function C(G,H){if(G=='freemarker-identifier'){g.style='freemarker-directive';if(l&&H.toLowerCase()==l.name)t();else q();}o();};function D(G,H){if(H=='/>'||H=='>')p();else o(D);};function E(G,H){if(H=='/]'||H==']')p();else o(E);};function F(G,H,I){return function(J,K){if(K==G||K==H&&b.hasOwnProperty(k))o();else if(K==H){s(k,I);o();}else{q();o(arguments.callee);}};};return{indentation:function(){return j;},next:function(){g=f.next();if(g.style=='whitespace'&&i==0)j=g.value.length;else i++;if(g.content=='\n'){j=i=0;g.indentation=u(l);}if(g.style=='whitespace'||g.type=='freemarker-comment')return g;for(;;){m=false;h.pop()(g.style,g.content);if(m)return g;}},copy:function(){var G=h.concat([]),H=f.state,I=l,J=this;return function(K){h=G.concat([]);i=j=0;l=I;f=c(K,H);return J;};}};};return{make:d,electricChars:'>'};})();
